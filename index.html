<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <style>
      body {
        background-color: lightblue;
        font-family: Arial, sans-serif;
      }
    </style>
  </head>
  <body>
    <h1>Like Hosting, but better!</h1>
    <p>Send simple messages, create simple websites, and do pretty much anything else small with QuerySite! QuerySite converts HTML data into a query string so you can send messages through URLs! Essentially, QuerySite hosts very small websites for free!</p>
    <textarea id="HTML" placeholder="Type your html content here">HTML Content</textarea>
    <a id="URL"></link>
    <script>
        const textarea = document.getElementById('HTML');
  const output = document.getElementById('URL');

  textarea.addEventListener('input', () => {
    const input = textarea.value;

    // 1. Compress the input using pako.gzip, returns Uint8Array
    const compressed = pako.gzip(input);
    

    // 2. Convert Uint8Array to binary string for base64 encoding
    function uint8ToString(u8Arr) {
      let str = "";
      for (let i = 0; i < u8Arr.length; i++) {
        str += String.fromCharCode(u8Arr[i]);
      }
      return str;
    }

    const binaryString = uint8ToString(compressed);

    // 3. Base64 encode using btoa
    const base64 = btoa(binaryString);

    const base64url = base64.replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');

    // Show output
    output.href = "https://QuerySite.github.io/show?data=" + base64url;
    output.textContent = "https://QuerySite.github.io/show?data=" + base64url;
  });

    </script>
  </body>
</html>
